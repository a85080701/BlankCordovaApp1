<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.4.5.min.css">
    <link rel="stylesheet" type="text/css" href="slick/slick.css">
    <link rel="stylesheet" type="text/css" href="slick/slick-theme.css">
    <script src="scripts/jquery-1.11.3.min.js"></script>
    <script src="scripts/jquery.mobile-1.4.5.min.js"></script>
    <script src="slick/slick.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBpOXj-mG3Zq0d69SdWtJ_VjVDlrGAZMvQ"></script>
    <script src="scripts/jquery.ui.map.min.js"></script>
    <title></title>
</head>
<body>
   

    <div data-role="page" id="AccordingCounty">
        <div data-role="header" data-position="fixed">
            <h1>門市</h1>
            <div data-role="navbar" data-mini="true">
                <ul>
                    <li>
                        <a class="ui-btn ui-corner-all ui-btn-active ui-state-persist" data-transition="none" href="AccordingCounty.html">依縣市</a>
                    </li>
                    <li>
                        <a class="ui-btn ui-corner-all " data-transition="none" href="AroundStore.html">最近門市</a>
                    </li>
                </ul>
            </div>
        </div>
        <div data-role="content">
            <form id="form1" runat="server">
                <label>請選擇縣市</label>
                <select id="list">
                    <option></option>
                    <option>台中市</option>
                    <option>台北市</option>
                    <option>台南市</option>
                </select>
                <div id="map_canvas" style="height:300px; width:100%"></div>
            </form>
        </div>
        <div data-role="footer" data-position="fixed">
            <div data-role="navbar" data-mini="true">
                <ul>
                    <li>
                        <a class="ui-btn ui-corner-all  ui-icon-home ui-btn-icon-top " href="index.html">首頁</a>
                    </li>
                    <li>
                        <a class="ui-btn ui-corner-all  ui-icon-bullets ui-btn-icon-top" href="Order.html">點餐</a>
                    </li>
                    <li>
                        <a class="ui-btn ui-corner-all  ui-icon-heart ui-btn-icon-top" href="Offer.html">優惠</a>
                    </li>
                    <li>
                        <a class="ui-btn ui-corner-all  ui-icon-location ui-btn-icon-top ui-btn-active ui-state-persist" href="Stores.html">門市</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
  
    <script>
        
        $(document).on('ready', function () {
            alert('123');
        });
            //Google Map for according county 24.1662731 , 120.7218959
            function MapFunction(data) {
                var latlng = new google.maps.LatLng(data.lat, data.lng);
                var mapOptions = {
                    enableHighAccuracy: true,
                    zoom: 14, //初始放大倍數
                    center: latlng, //中心點所在位置
                    mapTypeId: google.maps.MapTypeId.ROADMAP //正常2D道路模式
                };
                var map = new google.maps.Map(
                     document.getElementById("map_canvas"), mapOptions);
                var marker = new google.maps.Marker({
                    position: latlng,
                    map: map,
                    title: data.name
                });
            }


            var sel = $('select[id="list"]'); //指定要處理的特定元素物件名稱
            sel.on('change', function () {
                alert($)
                switch (true) {
                    
                    case sel.val() == "台中市":
                        
                        var poststore = JSON.stringify(getstore = { "county": "台中市" });
                        $.ajax({
                            type: "POST",
                            url: "http://localhost/TEST/HandlerStore.ashx",
                            data: poststore,
                            dataType: "json",
                            contentType: "application/json; charset=utf-8",
                            success: function (data) {
                                console.dir('aaa')
                                return MapFunction(data);
                            },
                            error: function (data) {
                                alert("Fail" + data);
                            }
                        });
                        break;
                    case sel.val() == "台北市":
                        var poststore = JSON.stringify(getstore = { "county": "台北市" });
                        $.ajax({
                            type: "POST",
                            url: "http://localhost/TEST/HandlerStore.ashx",
                            data: poststore,
                            dataType: "json",
                            contentType: "application/json; charset=utf-8",
                            success: function (data) {
                                return MapFunction(data);
                            },
                            error: function (data) {
                                alert("Fail" + data);
                            }
                        });
                        break;
                    case sel.val() == "台南市":
                        var poststore = JSON.stringify(getstore = { "county": "台南市" });
                        $.ajax({
                            type: "POST",
                            url: "http://localhost/TEST/HandlerStore.ashx",
                            data: poststore,
                            dataType: "json",
                            contentType: "application/json; charset=utf-8",
                            success: function (data) {
                                return MapFunction(data);
                            },
                            error: function (data) {
                                alert("Fail" + data);
                            }
                        });
                        break;
                }
            });

    </script>
</body>
</html>